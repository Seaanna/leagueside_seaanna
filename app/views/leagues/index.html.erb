<p id="notice"><%= notice %></p>

<h1>Leagues</h1>

<%= form_tag leagues_path, method: :get do %>
  <p>Search Leagues</p>
  <p>Latitude</p>
  <%= text_field_tag :lat, params[:lat], id: "lat" %>
  <p>Longitude</p>
  <%= text_field_tag :long, params[:long], id: "long" %>
  <p>Search Radius</p>
  <%= number_field_tag :radius, params[:radius] %>
  <p>Budget</p>
  <%= number_field_tag :budget, params[:budget] %>
  <%= submit_tag "Search", name: nil %>
<% end %>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Price</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @leagues.each do |league| %>
      <tr>
        <td><%= league.name %></td>
        <td><%= league.latitude %></td>
        <td><%= league.longitude %></td>
        <td><%= league.price %></td>
        <td><%= link_to 'Show', league %></td>
        <td><%= link_to 'Edit', edit_league_path(league) %></td>
        <td><%= link_to 'Destroy', league, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New League', new_league_path %>

<script>
  function initGeolocation()
  {
    if( navigator.geolocation )
    {
        // Call getCurrentPosition with success and failure callbacks
        navigator.geolocation.getCurrentPosition( success, fail );
    }
    else
    {
        alert("Sorry, your browser does not support geolocation services.");
    }
  }

  function success(position)
  {

      document.getElementById('long').value = position.coords.longitude;
      document.getElementById('lat').value = position.coords.latitude
  }

  function fail()
  {
    // Could not obtain location
  }

  initGeolocation()
</script>
